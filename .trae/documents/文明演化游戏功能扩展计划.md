# 文明演化游戏功能扩展计划

## 功能概述
为文明演化游戏添加文明灭亡、复兴、合并、分裂的支持，丰富游戏的演化内容和趣味性。

## 实现方案

### 1. 文明灭亡

**条件设置：**
- 人口低于1000
- 领土格子数为0
- 综合实力（科技+文化+经济+军事）低于50
- 连续10个时间单位（100年）处于衰退状态

**实现步骤：**
1. 在Civilization类中添加`isDeclining`和`declineYears`属性，用于跟踪文明衰退状态
2. 在Simulator类的evolve()方法中添加灭亡检查逻辑
3. 当文明满足灭亡条件时，从文明列表中移除，并更新地图和UI
4. 保存灭亡文明的历史数据，用于复兴功能

### 2. 文明复兴

**条件设置：**
- 灭亡文明的文化遗产高于阈值（原文明文化值的50%）
- 地图上存在适合复兴的无主区域（至少5个连续格子）
- 距离灭亡时间超过500年
- 周围没有强大的文明（周围文明实力低于原文明巅峰实力的30%）

**实现步骤：**
1. 添加灭亡文明历史记录数组，保存灭亡文明的基本信息和巅峰数据
2. 在Simulator类中添加复兴检查逻辑
3. 当满足复兴条件时，创建新文明，继承原文明的部分属性和名称前缀
4. 分配初始领土和属性，更新UI

### 3. 文明合并

**条件设置：**
- 两个文明关系值高于80
- 地理位置相邻（至少有一个相邻格子）
- 文化差异低于20
- 经济差异低于30
- 双方均为非扩张主义策略

**实现步骤：**
1. 在updateCivilizationRelations()方法中添加合并检查逻辑
2. 当满足合并条件时，创建新文明，继承两个文明的优势属性
3. 移除原两个文明，更新地图和UI
4. 生成合并事件，记录到时间线

### 4. 文明分裂

**条件设置：**
- 文明领土格子数超过50
- 内部文化差异超过50（不同区域文化值差异）
- 经济差距超过40（不同区域经济值差异）
- 连续5个时间单位（50年）处于不稳定状态

**实现步骤：**
1. 在Civilization类中添加`isUnstable`和`unstableYears`属性
2. 在evolve()方法中添加分裂检查逻辑
3. 当满足分裂条件时，将文明分裂为两个新文明
4. 分配领土和属性，更新地图和UI
5. 生成分裂事件，记录到时间线

## 代码修改计划

### 1. 修改Civilization类
- 添加衰退、不稳定状态跟踪属性
- 添加巅峰数据记录属性

### 2. 修改Simulator类
- 添加灭亡文明历史记录数组
- 在evolve()方法中添加灭亡、复兴、分裂检查逻辑
- 在updateCivilizationRelations()方法中添加合并检查逻辑
- 添加文明合并、分裂、灭亡、复兴的具体实现方法
- 更新事件生成逻辑，添加相关事件

### 3. 修改MapSystem类
- 添加无主区域检查方法
- 添加适合复兴区域检查方法

### 4. 修改UISystem类
- 更新UI以支持文明数量变化
- 添加相关事件的时间线显示

## 预期效果
- 文明会因为各种原因灭亡，增加游戏的真实感
- 灭亡的文明有可能复兴，延续历史脉络
- 文明之间可以合并，形成更大的文明
- 强大的文明可能分裂，产生新的文明
- 丰富的事件记录，展示文明的演化历程

## 技术要点
- 确保文明数量变化时地图和UI的正确更新
- 合理设置各项条件的阈值，平衡游戏难度
- 保存和恢复文明历史数据，支持复兴功能
- 生成丰富的事件描述，增强游戏的故事性