# 文明演化模拟器改进计划

## 1. 资源生产与消耗机制

### 问题分析
当前资源系统只提供静态buff，没有动态生产和消耗逻辑，导致资源价值单一。

### 改进方案
- **添加资源生产逻辑**：根据格子属性（经济、科技）生成资源
- **添加资源消耗机制**：文明发展需要消耗资源，人口增长消耗食物
- **资源动态平衡**：资源数量随时间变化，形成供需关系

### 具体实现
1. 在`simulator.js`的`updateCellAttributes`方法中添加资源生产逻辑
2. 在`aggregateCellAttributesToCivilizations`方法中添加文明资源消耗
3. 为每个文明添加资源库存属性
4. 实现资源在文明间的分配机制

## 2. 文明发展与扩张速度调整

### 问题分析
当前文明发展过快，格子属性迅速达到上限，势力范围快速扩张，导致游戏节奏过快。

### 改进方案
- **降低属性增长速率**：调整`updateCellAttributes`中的基础增长率
- **增加扩张难度**：调整影响力计算公式，增加距离衰减
- **降低初始属性**：调整`assignInitialTerritory`中的初始属性分配
- **添加发展瓶颈**：随着文明规模扩大，增长速度逐渐减缓

### 具体实现
1. 降低`updateCellAttributes`中的基础增长率（从0.01调整为0.005）
2. 调整`calculateInfluence`中的距离衰减公式，增加衰减系数
3. 降低初始属性分配比例（从0.5调整为0.3）
4. 为文明添加规模惩罚机制，随着领土扩大，增长效率降低

## 3. 防止一家独大的平衡机制

### 问题分析
当前系统缺乏对强势文明的限制，导致最终总是一家独大，游戏缺乏后续变化。

### 改进方案
- **添加文明内部矛盾机制**：随着文明规模扩大，内部稳定性下降
- **添加文明分裂机制**：当文明过大或内部矛盾过高时可能分裂
- **添加弱势文明联合机制**：弱势文明可能联合对抗强势文明
- **添加随机事件影响**：增加对强势文明的负面事件概率

### 具体实现
1. 在`civilization.js`中添加稳定性属性
2. 在`updateCivilizationRelations`中添加联合机制
3. 在`generateRandomEvent`中增加针对强势文明的负面事件
4. 实现文明分裂逻辑，当稳定性低于阈值时触发

## 4. 其他优化

### 问题分析
当前系统还有一些其他需要优化的地方，如UI显示、事件系统等。

### 改进方案
- **优化资源显示**：在UI中显示文明资源库存
- **增强事件系统**：增加更多类型的事件，尤其是影响文明发展的关键事件
- **优化地图渲染**：改进资源点显示，增加资源动态变化的视觉反馈

### 具体实现
1. 在`ui.js`中添加资源库存显示
2. 在`simulator.js`中增加更多事件类型
3. 在`map.js`中改进资源点渲染，显示资源数量变化

## 5. 实现顺序

1. 资源生产与消耗机制
2. 文明发展与扩张速度调整
3. 防止一家独大的平衡机制
4. UI优化和事件系统增强

## 预期效果

- 游戏节奏更加合理，文明发展和扩张速度适中
- 资源系统更加动态，形成真实的供需关系
- 文明间的竞争更加平衡，避免一家独大
- 游戏后期仍有变化和挑战，增加可玩性

通过以上改进，文明演化模拟器将更加真实、平衡和具有挑战性，提供更好的游戏体验。