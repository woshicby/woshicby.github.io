# 资源系统格子化改造计划

## 目标
修改资源系统，确保所有资源的获取和消耗都在格子层面结算，文明的资源数值直接等于其占领格子的资源总和。

## 主要修改内容

### 1. 移除文明层面的资源库存
- 删除 `Civilization` 类中的 `resources` 属性
- 移除文明初始化时的资源赋值
- 文明不再拥有独立的资源库存

### 2. 移除文明层面的资源消耗机制
- 删除 `aggregateCellAttributesToCivilizations` 方法中的文明资源消耗逻辑
- 移除文明资源短缺对文明属性的直接影响

### 3. 强化格子层面的资源生产和消耗
- 确保所有资源的生产和消耗都在 `updateCellAttributes` 方法中处理
- 优化资源平衡，确保生产和消耗在格子层面达到动态平衡
- 增强资源短缺对格子属性的影响

### 4. 修改文明属性汇总逻辑
- 文明的资源状态直接通过汇总其所有占领格子的资源数量得到
- 文明的属性（科技、文化、经济、军事、人口）保持不变，仍为所有占领格子的总和

### 5. 优化资源调度机制
- 保持格子间的资源调度功能，但移除文明级别的资源分配
- 确保资源调度在格子层面合理进行

### 6. 修改UI显示逻辑
- 确保UI中显示的文明资源数量直接来自其占领格子的资源总和
- 更新资源显示方式，反映格子化资源系统

## 具体修改步骤

1. **修改 `Civilization` 类**
   - 删除资源库存属性和相关初始化代码

2. **修改 `aggregateCellAttributesToCivilizations` 方法**
   - 移除文明资源收集和消耗逻辑
   - 保留文明属性汇总逻辑

3. **优化 `updateCellAttributes` 方法**
   - 增强格子层面的资源生产和消耗平衡
   - 确保资源短缺对格子属性的合理影响

4. **修改 `scheduleResources` 方法**
   - 确保资源调度仅在格子间进行
   - 移除文明级别的资源处理

5. **更新UI相关代码**
   - 修改文明资源显示，直接汇总格子资源
   - 更新资源状态的显示逻辑

## 预期效果
- 资源系统更加真实，所有资源流动都在格子层面进行
- 文明的资源状态直接反映其领土内的资源状况
- 资源平衡更加稳定，避免文明级别的资源暴涨或短缺
- 游戏机制更加统一，所有属性都遵循相同的汇总规则

## 风险评估
- 需要确保格子层面的资源生产和消耗能够维持文明的正常发展
- 需要调整资源平衡参数，避免出现过度短缺或过剩
- 需要确保UI能够正确显示文明的资源状态