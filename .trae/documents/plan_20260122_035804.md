# 多文明演化模拟器地图系统改进计划

## 1. 改进文明实力范围可视化

### 实现思路
- 在现有领土显示基础上，添加文明实力范围的视觉表示
- 通过颜色深浅或纹理变化表示实力强弱
- 实力范围基于文明的综合实力和领土大小

### 具体实现
- **实力计算**：综合文明的人口、军事、经济和文化计算实力值
- **实力可视化**：
  - 为每个格子添加实力强度值
  - 基于实力强度调整领土颜色的亮度或饱和度
  - 实力越强，颜色越深或越鲜艳
  - 争议地带显示双方实力的混合效果
- **UI增强**：
  - 添加实力范围图例
  - 鼠标悬停显示具体实力数值
  - 可选：添加实力范围动画效果

## 2. 为地图格子提供更多信息

### 实现思路
- 将文明的各项数值分布到其占领的各个格子上
- 每个格子拥有独立的科技、文化、经济、军事和人口数值
- 格子数值受格子类型和文明整体属性影响

### 具体实现
- **格子数据结构扩展**：
  - 为每个格子添加tech、culture、economy、military和population属性
  - 记录格子的发展历史
- **属性分配算法**：
  - 基于文明中心距离分配基础属性
  - 不同地形对不同属性有加成/惩罚
  - 格子属性总和影响文明整体属性
- **动态更新机制**：
  - 每次演化时更新格子属性
  - 文明属性变化时重新分配到格子
  - 格子之间的属性扩散和影响
- **信息展示**：
  - 鼠标悬停显示格子详细信息
  - 可选：添加格子信息面板
  - 不同属性使用不同颜色标识

## 3. 解除文明数据上限，改为格子级别的限制

### 实现思路
- 移除文明级别的属性上限（目前是100）
- 为每种地图格子设置不同的属性上限
- 文明整体属性由其所有格子的属性总和决定

### 具体实现
- **移除文明级别的属性上限**：
  - 修改`updateStats()`方法，移除`Math.min(100, ...)`限制
  - 文明整体属性改为所有格子属性的总和
- **添加格子级别的属性限制**：
  - 为每种地形类型设置不同的属性上限
  - 平原：经济和人口上限高
  - 森林：文化上限高
  - 丘陵：军事上限高
  - 山脉：科技上限高
  - 海洋：特殊属性限制
- **格子属性更新逻辑**：
  - 每个格子的属性增长受自身上限和文明整体发展影响
  - 当格子属性达到上限时，影响会扩散到邻近格子
  - 不同属性的增长速度受格子类型影响

## 4. 技术实现步骤

1. **修改数据结构**：
   - 扩展地图格子数据结构，添加各项属性
   - 移除文明级别的属性上限
   - 添加格子类型的属性限制配置

2. **实现属性分配和计算**：
   - 编写属性分配算法
   - 实现格子属性到文明属性的汇总
   - 实现格子间的属性扩散机制

3. **改进地图可视化**：
   - 添加实力范围的视觉表示
   - 实现格子信息的悬停显示
   - 优化领土颜色的显示效果

4. **更新UI组件**：
   - 添加实力范围图例
   - 可选：添加格子信息面板
   - 调整文明详情面板，显示基于格子的统计信息

5. **测试和优化**：
   - 测试性能，确保大量格子时游戏流畅
   - 调整属性平衡，确保游戏可玩性
   - 优化视觉效果，确保信息清晰易读

## 预期效果
- 地图上能清晰看出每个文明的实力范围和强弱
- 每个格子拥有丰富的属性信息，反映文明的发展状况
- 文明发展不再受固定上限限制，而是受领土质量和面积影响
- 不同类型的格子对文明发展有不同的影响，增加游戏策略性
- 游戏整体更具深度和可玩性，能够展示更复杂的文明发展过程

这些改进将使游戏的地图系统更加丰富和直观，能够更好地展示文明的发展和实力分布，符合用户对更真实、更复杂文明演化的预期。