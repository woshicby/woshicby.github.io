# 文明演化模拟器优化计划

## 1. 基于格子的文明影响区域

### 实现思路
- 将圆形影响力范围替换为基于格子的领土系统
- 每个格子根据文明影响力分配所有权
- 支持邻近文明的争议地带

### 具体实现
- **添加领土管理**：在Simulator类中添加`territory`数组，记录每个格子的所有者
- **影响力计算**：
  - 为每个格子计算所有文明的影响力值
  - 影响力 = 基础影响力 - 距离衰减 + 文明属性加成
  - 基础影响力基于文明的人口、军事、经济和文化
  - 距离衰减：影响力随距离文明中心呈指数衰减
- **领土分配**：
  - 每个格子分配给影响力最高的文明
  - 争议地带：当两个或多个文明影响力差值在阈值内时标记为争议区域
- **地图绘制优化**：
  - 绘制每个格子时叠加文明颜色，表示所有权
  - 争议地带使用特殊混合颜色
  - 保留文明中心图标

## 2. 文明中心迁移功能

### 实现思路
- 允许文明通过事件和策略迁移中心
- 迁移会产生相关影响

### 具体实现
- **迁移触发机制**：
  - 随机事件（如自然灾害、资源枯竭）
  - 策略驱动（如扩张主义文明主动迁移）
  - 外部压力（如被其他文明攻击）
- **迁移效果**：
  - 短期：统计数据临时下降（迁移成本）
  - 中期：失去部分原有领土
  - 长期：可能获得新资源和发展机会
- **UI更新**：
  - 地图上显示文明中心迁移轨迹
  - 时间线记录迁移事件
  - 文明详情显示迁移历史

## 3. 丰富事件系统

### 实现思路
- 扩展现有事件类型
- 添加事件分类和影响机制
- 增加事件与游戏系统的关联性

### 具体实现
- **事件分类**：
  - 自然灾害（地震、洪水、瘟疫）
  - 技术突破（发明、发现）
  - 政治事件（革命、政变、联盟）
  - 经济事件（繁荣、衰退、资源发现）
  - 文化事件（文化革命、宗教兴起）
  - 军事事件（战争、入侵、防御）
  - 迁移事件（主动迁移、被迫迁移）
- **事件数量**：
  - 扩展至50+种事件类型
  - 每种类型有多种变体
- **事件影响**：
  - 修改文明统计数据
  - 影响文明关系
  - 触发领土变化
  - 引发连锁事件
- **事件生成逻辑**：
  - 基于文明策略和当前状态
  - 考虑文明间关系
  - 考虑地理环境

## 4. 技术实现步骤

1. **修改核心数据结构**：
   - 为Civilization类添加领土和迁移相关属性
   - 为Simulator类添加领土管理

2. **实现影响力计算**：
   - 编写格子影响力计算函数
   - 实现领土分配逻辑

3. **更新地图绘制**：
   - 替换圆形影响力为格子领土
   - 添加争议地带显示

4. **实现迁移机制**：
   - 添加迁移方法到Civilization类
   - 实现迁移效果

5. **扩展事件系统**：
   - 添加新事件类型
   - 实现事件影响逻辑
   - 优化事件生成算法

6. **测试和优化**：
   - 测试所有新功能
   - 优化性能
   - 调整平衡

## 预期效果

- 文明影响区域更加真实，基于格子系统展示
- 支持文明间的领土争端和扩张
- 文明可以通过迁移适应环境变化
- 丰富的事件系统提供更多动态变化和剧情
- 游戏整体更具深度和策略性

这些改进将使游戏更加接近"钢铁雄心"的体验，展示文明演化的复杂性和多样性。